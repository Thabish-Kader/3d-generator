version: 1
frontend:
    phases:
        preBuild:
            commands:
                - npm ci
        build:
            commands:
                - echo "NEXTAUTH_SECRET=$NEXTAUTH_SECRET" >> .env
                - echo "NEXTAUTH_URL=$NEXTAUTH_URL" >> .env
                - echo "GOOGLE_CLIENT_ID=$GOOGLE_CLIENT_ID" >> .env
                - echo "GOOGLE_CLIENT_SECRET=$GOOGLE_CLIENT_SECRET" >> .env
                - echo "STRIPE_API_KEY=$STRIPE_API_KEY" >> .env
                - echo "STRIPE_SECRET_KEY=$STRIPE_SECRET_KEY" >> .env
                - echo "STRIPE_WEBHOOK_SECRET=$STRIPE_WEBHOOK_SECRET" >> .env
                - echo "PRICE_ID=$PRICE_ID" >> .env
                - echo "NEXT_PUBLIC_STRIPE_PUBLISHABLE_KEY=$NEXT_PUBLIC_STRIPE_PUBLISHABLE_KEY" >> .env
                - echo "REGION=$REGION" >> .env
                - echo "ACCESS_KEY_ID=$ACCESS_KEY_ID" >> .env
                - echo "SECRET_ACCESS_KEY=$SECRET_ACCESS_KEY" >> .env
                - npm run build
    artifacts:
        baseDirectory: .next
        files:
            - "**/*"
    cache:
        paths:
            - node_modules/**/*
            - .next/cache/**/*
